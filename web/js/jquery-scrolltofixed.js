!function(C){C.isScrollToFixed=function(o){return!!C(o).data("ScrollToFixed")},C.ScrollToFixed=function(o,i){var n=this;n.$el=C(o),n.el=o,n.$el.data("ScrollToFixed",n);var s,r,e,t,l=!1,d=n.$el,p=0,c=0,x=-1,f=-1,u=null;function a(){var o=n.options.limit;return o?"function"==typeof o?o.apply(d):o:0}function F(){return"fixed"===s}function g(){return"absolute"===s}function T(){return!(F()||g())}function S(){F()||(u.css({display:d.css("display"),width:d.outerWidth(!0),height:d.outerHeight(!0),float:d.css("float")}),cssOptions={"z-index":n.options.zIndex,position:"fixed",top:-1==n.options.bottom?h():"",bottom:-1==n.options.bottom?"":n.options.bottom,"margin-left":"0px"},n.options.dontSetWidth||(cssOptions.width=d.width()),d.css(cssOptions),d.addClass(n.options.baseClassName),n.options.className&&d.addClass(n.options.className),s="fixed")}function b(){var o=a(),i=c;n.options.removeOffsets&&(i="",o-=p),cssOptions={position:"absolute",top:o,left:i,"margin-left":"0px",bottom:""},n.options.dontSetWidth||(cssOptions.width=d.width()),d.css(cssOptions),s="absolute"}function m(){T()||(f=-1,u.css("display","none"),d.css({"z-index":t,width:"",position:r,left:"",top:e,"margin-left":""}),d.removeClass("scroll-to-fixed-fixed"),n.options.className&&d.removeClass(n.options.className),s=null)}function w(o){o!=f&&(d.css("left",c-o),f=o)}function h(){var o=n.options.marginTop;return o?"function"==typeof o?o.apply(d):o:0}function v(){if(C.isScrollToFixed(d)){var o=l;l?T()&&(p=d.offset().top,c=d.offset().left):(d.trigger("preUnfixed.ScrollToFixed"),m(),d.trigger("unfixed.ScrollToFixed"),f=-1,p=d.offset().top,c=d.offset().left,n.options.offsets&&(c+=d.offset().left-d.position().left),-1==x&&(x=c),s=d.css("position"),l=!0,-1!=n.options.bottom&&(d.trigger("preFixed.ScrollToFixed"),S(),d.trigger("fixed.ScrollToFixed")));var i=C(window).scrollLeft(),e=C(window).scrollTop(),t=a();n.options.minWidth&&C(window).width()<n.options.minWidth?T()&&o||(U(),d.trigger("preUnfixed.ScrollToFixed"),m(),d.trigger("unfixed.ScrollToFixed")):n.options.maxWidth&&C(window).width()>n.options.maxWidth?T()&&o||(U(),d.trigger("preUnfixed.ScrollToFixed"),m(),d.trigger("unfixed.ScrollToFixed")):-1==n.options.bottom?0<t&&e>=t-h()?g()&&o||(U(),d.trigger("preAbsolute.ScrollToFixed"),b(),d.trigger("unfixed.ScrollToFixed")):e>=p-h()?(F()&&o||(U(),d.trigger("preFixed.ScrollToFixed"),S(),f=-1,d.trigger("fixed.ScrollToFixed")),w(i)):T()&&o||(U(),d.trigger("preUnfixed.ScrollToFixed"),m(),d.trigger("unfixed.ScrollToFixed")):0<t?e+C(window).height()-d.outerHeight(!0)>=t-(h()||-(n.options.bottom?n.options.bottom:0))?F()&&(U(),d.trigger("preUnfixed.ScrollToFixed"),"absolute"===r?b():m(),d.trigger("unfixed.ScrollToFixed")):(F()||(U(),d.trigger("preFixed.ScrollToFixed"),S()),w(i),d.trigger("fixed.ScrollToFixed")):w(i)}}function U(){var o=d.css("position");"absolute"==o?d.trigger("postAbsolute.ScrollToFixed"):"fixed"==o?d.trigger("postFixed.ScrollToFixed"):d.trigger("postUnfixed.ScrollToFixed")}var z=function(o){d.is(":visible")&&(l=!1,v())},A=function(o){window.requestAnimationFrame?requestAnimationFrame(v):v()};n.init=function(){n.options=C.extend({},C.ScrollToFixed.defaultOptions,i),t=d.css("z-index"),n.$el.css("z-index",n.options.zIndex),u=C("<div />"),s=d.css("position"),r=d.css("position"),e=d.css("top"),T()&&n.$el.after(u),C(window).bind("resize.ScrollToFixed",z),C(window).bind("scroll.ScrollToFixed",A),"ontouchmove"in window&&C(window).bind("touchmove.ScrollToFixed",v),n.options.preFixed&&d.bind("preFixed.ScrollToFixed",n.options.preFixed),n.options.postFixed&&d.bind("postFixed.ScrollToFixed",n.options.postFixed),n.options.preUnfixed&&d.bind("preUnfixed.ScrollToFixed",n.options.preUnfixed),n.options.postUnfixed&&d.bind("postUnfixed.ScrollToFixed",n.options.postUnfixed),n.options.preAbsolute&&d.bind("preAbsolute.ScrollToFixed",n.options.preAbsolute),n.options.postAbsolute&&d.bind("postAbsolute.ScrollToFixed",n.options.postAbsolute),n.options.fixed&&d.bind("fixed.ScrollToFixed",n.options.fixed),n.options.unfixed&&d.bind("unfixed.ScrollToFixed",n.options.unfixed),n.options.spacerClass&&u.addClass(n.options.spacerClass),d.bind("resize.ScrollToFixed",function(){u.height(d.height())}),d.bind("scroll.ScrollToFixed",function(){d.trigger("preUnfixed.ScrollToFixed"),m(),d.trigger("unfixed.ScrollToFixed"),v()}),d.bind("detach.ScrollToFixed",function(o){var i;(i=(i=o)||window.event).preventDefault&&i.preventDefault(),i.returnValue=!1,d.trigger("preUnfixed.ScrollToFixed"),m(),d.trigger("unfixed.ScrollToFixed"),C(window).unbind("resize.ScrollToFixed",z),C(window).unbind("scroll.ScrollToFixed",A),d.unbind(".ScrollToFixed"),u.remove(),n.$el.removeData("ScrollToFixed")}),z()},n.init()},C.ScrollToFixed.defaultOptions={marginTop:0,limit:0,bottom:-1,zIndex:1e3,baseClassName:"scroll-to-fixed-fixed"},C.fn.scrollToFixed=function(o){return this.each(function(){new C.ScrollToFixed(this,o)})}}(jQuery);